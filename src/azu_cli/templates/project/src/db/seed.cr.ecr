require "cql"
require "../initializers/database"
require "../models/*"

# Database seed file for <%= @project.capitalize %>
# This file contains sample data for development and testing
# Run with: azu db:seed

puts "🌱 Seeding database for <%= @project %>..."

# Ensure we're connected to the database
unless AppSchema.connected?
  puts "❌ Database not connected. Run 'azu db:create' and 'azu db:migrate' first."
  exit(1)
end

# Clear existing data (optional - uncomment if needed)
# puts "  🗑️  Clearing existing data..."
# User.delete_all
# Post.delete_all

# Create sample data
begin
  # Example: Create sample users
  puts "  👥 Creating sample users..."

  admin_user = User.create!(
    name: "Admin User",
    email: "admin@<%= @project %>.com",
    active: true
  )

  demo_user = User.create!(
    name: "Demo User",
    email: "demo@<%= @project %>.com",
    active: true
  )

  puts "    ✅ Created #{User.count} users"

  # Example: Create sample posts (if Post model exists)
  # puts "  📝 Creating sample posts..."
  #
  # Post.create!(
  #   title: "Welcome to <%= @project.capitalize %>",
  #   content: "This is your first post in the <%= @project %> application!",
  #   user: admin_user,
  #   published: true
  # )
  #
  # Post.create!(
  #   title: "Getting Started Guide",
  #   content: "Here's how to get started with this application...",
  #   user: admin_user,
  #   published: true
  # )
  #
  # puts "    ✅ Created #{Post.count} posts"

  puts "🎉 Seeding completed successfully!"
  puts "📊 Database now contains:"
  puts "   Users: #{User.count}"
  # puts "   Posts: #{Post.count}"  # Uncomment when you have Post model

rescue => ex
  puts "❌ Seeding failed: #{ex.message}"
  puts "💡 Make sure you have:"
  puts "   1. Created the database: azu db:create"
  puts "   2. Run migrations: azu db:migrate"
  puts "   3. Defined your models in src/models/"
  exit(1)
end
