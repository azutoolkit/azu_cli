---
description:
globs:
alwaysApply: false
---

# ğŸ”§ Azu CLI Code Generator Prompt (.mdc)

## âœ… Project Context

- **Project Name**: Azu CLI Code Generator
- **One-liner**: Generates structured Azu framework components using interactive CLI and OptionParser.
- **Audience**: Experienced Crystal developers, backend engineers building modern apps with Azu.

## ğŸ§  Objective

Create an intelligent code generator that:

- Uses Crystal and `OptionParser` for CLI interaction.
- Outputs Crystal code using ECR templates.
- Scaffolds endpoints, models, services, requests, responses, validators, middleware, jobs, migrations, components, templates, and channels.
- Writes to: `src/azu_cli/templates/scaffold/src/{{name}}/`.

## ğŸ’¡ Generation Rules

For each generator:

- Follows Azu conventions (e.g., type-safe, idiomatic Crystal).
- Accepts attributes/types/flags via CLI options.
- Generates directory-aligned code (e.g., `src/models/user.cr`).
- Injects correct imports, validations, and stubs.
- Must compile successfully with `crystal build`.

## ğŸ› ï¸ Example Prompt

```prompt
Generate a Crystal class `Generate::Model` for the Azu CLI that:
- Inherits from `Teeplate::FileTree`.
- Accepts `name`, `attributes`, and `--timestamps` flags via `OptionParser`.
- Writes ECR templates to `src/azu_cli/templates/scaffold/src/{{name}}/models/{{file}}.ecr`.
- Supports types: `String`, `Int32`, `Bool`, `Time`, `Float64`.
- Produces a `src/models/{{snake_case(name)}}.cr` file with a CQL::Model struct and `db_context`.
```

## Template Directory Structure

```
{project}/
â””â”€â”€ src/
    â””â”€â”€ {{name}}/
        â”œâ”€â”€ models/
        â”‚   â””â”€â”€ {{snake_case}}.ecr
        â”œâ”€â”€ services/
        â”‚   â””â”€â”€ {{snake_case}}.ecr
        â”œâ”€â”€ endpoints/
        â”‚   â””â”€â”€ {{snake_case}}.ecr
        â”œâ”€â”€ requests/
        â”‚   â””â”€â”€ {{snake_case}}.ecr
        â”œâ”€â”€ responses/
        â”‚   â””â”€â”€ {{snake_case}}.ecr
        â”œâ”€â”€ validators/
        â”‚   â””â”€â”€ {{snake_case}}.ecr
        â”œâ”€â”€ middleware/
        â”‚   â””â”€â”€ {{snake_case}}.ecr
        â”œâ”€â”€ components/
        â”‚   â””â”€â”€ {{snake_case}}.ecr
        â”œâ”€â”€ jobs/
        â”‚   â””â”€â”€ {{snake_case}}.ecr
        â”œâ”€â”€ channels/
        â”‚   â””â”€â”€ {{snake_case}}.ecr
        â””â”€â”€ db/
            â”œâ”€â”€ migrations/
            â””â”€â”€ seeds.cr.ecr
```

## ğŸ¯ Component-Specific Guidance

Each component should:
â€¢ Reflect Azuâ€™s architectural style.
â€¢ Be type-safe and idiomatic to Crystal.
â€¢ Reference generated files when applicable (e.g., validators inside models).

## ğŸ”„ Interactive CLI Prompts

Use Crystalâ€™s OptionParser to:
â€¢ Prompt --name, --attributes, --timestamps, --relations, etc.
â€¢ Allow defaults and help messages.
â€¢ E.g. azu generate model User name:String age:Int32 --timestamps

## âœ… Example Use Cases

1. azu generate model User name:String age:Int32
2. azu generate endpoint CreateUser user_request user_response --method POST --path /api/users
3. azu generate validator EmailValidator email:String
4. azu generate service UserService
5. azu generate component ChatComponent --props current_user:String

# ğŸ§ª Acceptance Criteria

â€¢ Generated code compiles without errors.
â€¢ Directory structure is correct.
â€¢ Template values are correctly interpolated.
â€¢ Imports and require directives are included.
â€¢ CLI shows help and validations via OptionParser.
